@model InMyAppinion.Models.ProfessorViewModels.ProfessorDetailViewModel
@using Microsoft.AspNetCore.Authorization
@inject IAuthorizationService AuthorizationService

@{
    ViewData["Title"] = "Profesor";
}

<div>
    <div class="container">
        <div class="resume">
            <header class="page-header">
                <h1 class="page-title">@Model.FirstName @Model.LastName</h1>
                <small> @Html.DisplayNameFor(m => m.Validated): @(Model.Validated ? "Da" : "Ne")</small>
            </header>
            <div class="row">
                <div class="col-xs-12 col-sm-12 col-md-offset-1 col-md-10 col-lg-offset-2 col-lg-8">
                    <div class="panel panel-default">
                        <div class="panel-heading resume-heading">
                            <div class="row">
                                <div class="col-lg-12">
                                    <div class="col-xs-12 col-sm-4">
                                        <figure>
                                            <img class="img-circle img-responsive" alt="" src="http://placehold.it/300x300">
                                        </figure>

                                        <div class="row">
                                            <div class="col-xs-12 social-btns">
                                                <!--Bilo bi dost dobro da ima opcionalni linkedin profil-->
                                                <div class="col-xs-3 col-md-1 col-lg-1 social-btn-holder">
                                                    <a href="#" class="btn btn-social btn-block btn-linkedin">
                                                        <i class="fa fa-linkedin"></i>
                                                    </a>
                                                </div>
                                            </div>
                                        </div>

                                    </div>
                                    <div class="col-xs-12 col-sm-8">
                                        <ul class="list-group">
                                            <li class="list-group-item">@Model.FirstName @Model.LastName</li>
                                            <li class="list-group-item">
                                                @if (Model.Faculties.Count != 0)
                                                {
                                                    @foreach (var faculty in Model.Faculties)
                                                    {
                                                        <div>@faculty.Name (@faculty.ShortName)</div>
                                                    }
                                                }
                                                else
                                                {
                                                    @Html.Raw("-")
                                                }
                                            </li>
                                            <li class="list-group-item">
                                                @if (Model.Universities.Count != 0)
                                                {
                                                    @foreach (var uni in Model.Universities)
                                                    {
                                                        <div>@uni.Name, @uni.City.Name (@uni.ShortName)</div>
                                                    }
                                                }
                                                else
                                                {
                                                    @Html.Raw("-")

                                                }
                                            </li>
                                            <!-- Bilo bi dost dobro da ima mail-->
                                            <li class="list-group-item"><i class="fa fa-envelope"></i> john@example.com</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="bs-callout bs-callout-danger">
                            <h4>@Html.DisplayNameFor(model => model.Biography)</h4>
                            <p>
                                @Html.DisplayFor(model => model.Biography)
                            </p>
                        </div>
                        <div class="bs-callout bs-callout-danger">
                            <h4>@Html.DisplayNameFor(model => model.Interests)</h4>
                            @if (Model.Faculties.Count != 0)
                            {
                                @foreach (var interes in Model.Interests)
                                {
                                    <div>@interes.Name</div>
                                    if (!Model.Interests.Last().Equals(interes))
                                    {
                                        @Html.Raw(", ")

                                    }
                                }
                            }
                            else
                            {
                                @Html.Raw("-")
                            }
                            
                        </div>
                        <div class="bs-callout bs-callout-danger">
                            <h4>Ocjene</h4>
                            <ul class="list-group">
                                <a class="list-group-item inactive-link" href="#">
                                    @foreach (var kvp in Model.Grades)
                                    {
                                        <div class="progress">
                                            <div data-placement="top"
                                                 style="width: @(kvp.Value.Percentage)%;"
                                                 aria-valuemax="10"
                                                 aria-valuemin="0"
                                                 aria-valuenow="@kvp.Value.Grade"
                                                 data-toggle="tooltip"
                                                 role="progressbar"
                                                 title="@kvp.Key"
                                                 class="progress-bar progress-bar-@(kvp.Value.Status)">

                                                <span class="sr-only">@(kvp.Value.Percentage)%</span>
                                                <span class="progress-type">@kvp.Key (@kvp.Value.Grade)</span>
                                            </div>
                                        </div>

                                    }
                                    <div class="progress-meter">
                                        <div style="width: 25%;" class="meter meter-left"><span class="meter-text">Dost lose</span></div>
                                        <div style="width: 25%;" class="meter meter-left"><span class="meter-text">Onako</span></div>
                                        <div style="width: 25%;" class="meter meter-right"><span class="meter-text">Dost dobro</span></div>
                                        <div style="width: 25%;" class="meter meter-right"><span class="meter-text">Dobro</span></div>
                                    </div>
                                </a>
                            </ul>
                        </div>
                        <div class="bs-callout bs-callout-danger">
                            <h4>Najocjenjenije recenzije</h4>
                            <ul class="list-group">
                                <a class="list-group-item inactive-link" href="#">
                                    <h4 class="list-group-item-heading">
                                        Software Engineer at Twitter
                                    </h4>
                                    <dd>
                                        @foreach (var item in Model.Reviews)
                                        {
                                            <a asp-action="Details" asp-controller="ProfessorReviews" asp-route-Id="@item.ID">@item.TotalGrade |</a>
                                        }
                                    </dd>
                                    <p class="list-group-item-text">

                                        Lorem ipsum dolor sit amet, ea vel prima adhuc, scripta liberavisse ea quo, te vel vidit mollis complectitur. Quis verear mel ne. Munere vituperata vis cu,
                                        te pri duis timeam scaevola, nam postea diceret ne. Cum ex quod aliquip mediocritatem, mei habemus persecuti mediocritatem ei.
                                    </p>
                                </a>
                                <a class="list-group-item inactive-link" href="#">
                                    <h4 class="list-group-item-heading">Software Engineer at LinkedIn</h4>
                                    <p class="list-group-item-text">
                                        Lorem ipsum dolor sit amet, ea vel prima adhuc, scripta liberavisse ea quo, te vel vidit mollis complectitur.
                                        Quis verear mel ne. Munere vituperata vis cu, te pri duis timeam scaevola,
                                        nam postea diceret ne. Cum ex quod aliquip mediocritatem, mei habemus persecuti mediocritatem ei.
                                    </p><ul>
                                        <li>
                                            Lorem ipsum dolor sit amet, ea vel prima adhuc, scripta liberavisse ea quo, te vel vidit mollis complectitur.
                                            Quis verear mel ne. Munere vituperata vis cu, te pri duis timeam scaevola,
                                            nam postea diceret ne. Cum ex quod aliquip mediocritatem, mei habemus persecuti mediocritatem ei.
                                        </li>
                                        <li>
                                            Lorem ipsum dolor sit amet, ea vel prima adhuc, scripta liberavisse ea quo, te vel vidit mollis complectitur.
                                            Quis verear mel ne. Munere vituperata vis cu, te pri duis timeam scaevola,
                                            nam postea diceret ne. Cum ex quod aliquip mediocritatem, mei habemus persecuti mediocritatem ei.
                                        </li>
                                    </ul>
                                    <p></p>
                                </a>
                            </ul>
                        </div>
                        <div class="bs-callout bs-callout-danger">
                            <h4>Kolegiji</h4>
                            <table class="table table-striped table-responsive ">
                                <thead>
                                    <tr>
                                        <th>Kolegiji</th>
                                        <th>Fakultet</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @foreach(var sub in Model.Subjects)
                                    {
                                        <tr>
                                            <td>
                                                <a asp-controller="Subjects" asp-action="Details" asp-route-id="@sub.ID">@sub.Name</a>
                                            </td>
                                            <td>@sub.Faculty.Name</td>
                                        </tr>
                                    }
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div>
    @if (await AuthorizationService.AuthorizeAsync(User, "CanModerate"))
    {
        <dt>
            @Html.DisplayNameFor(model => model.Validated)
        </dt>
            <dd>
                <form asp-action="Validate" method="post">
                    <input asp-for="@Model.Validated" data-professorid="@Model.ID" class="editajax" />
                </form>
            </dd>
    }

    @if (await AuthorizationService.AuthorizeAsync(User, "CanReview"))
    {
        <a asp-action="Create" asp-controller="ProfessorReviews" asp-route-Id="@Model.ID">Dodaj kritiku</a>@: |
    }
    <a asp-action="Edit" asp-route-id="@Model.ID">Edit</a> |
    <a asp-action="Index">Back to List</a>


</div>

<div id="chart1" style="height:200px;width:500px; "></div>

@section Scripts {
    <script type="text/javascript">
        $(function () {
            SetEditAjax(".editajax", '@Url.Action("Validate")','professorid');
        });
    </script>

    <script>
        $(function () {
            GraphByYear("chart1", '@Url.Action("GradeByYear", "Rank", new { id=Model.ID, type="professor"})');
        });
    </script>
    <script type="text/javascript">
        $(document).ready(function () {
            $('[data-toggle="tooltip"]').tooltip();
        });
    </script>
}

@section Styles {
    <link href="@Url.Content("~/css/professorProfile.css")" rel="stylesheet" type="text/css" />
}

